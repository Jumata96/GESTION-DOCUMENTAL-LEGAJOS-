<?php
bolt_decrypt( __FILE__ , 'GCrQJi'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnM7Cgp1c2UgSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3Q7CnVzZSBJbGx1bWluYXRlXFN1cHBvcnRcRmFjYWRlc1xIYXNoOwp1c2UgSWxsdW1pbmF0ZVxTdXBwb3J0XENvbGxlY3Rpb24gYXMgQ29sbGVjdGlvbjsKdXNlIERCOwp1c2UgVmFsaWRhdG9yOwp1c2UgQXV0aDsKCmNsYXNzIFVzdWFyaW9Db250cm9sbGVyIGV4dGVuZHMgQ29udHJvbGxlcgp7CiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoKQogICAgewogICAgICAgICR2YWxpZGEgPSAwOyAKICAgICAgICAvLy0tIFZhbGlkYWNpw7NuIHBhcmEgbW9zdHJhciBtZW5zYWplcyBhbCByZWFsaXphciB1biBDUlVECiAgICAgICAgJHZhbGlkYWNpb24gPSBEQjo6dGFibGUoJ3ZhbGlkYWNpb24nKQogICAgICAgICAgICAgICAgICAgICAgICAtPnNlbGVjdCgndmFsb3InKQogICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlKCdpZHVzdWFyaW8nLEF1dGg6OnVzZXIoKS0+aWQpLT5nZXQoKTsKCiAgICAgICAgZm9yZWFjaCAoJHZhbGlkYWNpb24gYXMgJHZhbCkgewogICAgICAgICAgICAkdmFsaWRhID0gJHZhbC0+dmFsb3I7CiAgICAgICAgfQogICAgICAgIGlmICgkdmFsaWRhID4gMCkgewogICAgICAgICAgICBEQjo6dGFibGUoJ3ZhbGlkYWNpb24nKQogICAgICAgICAgICAtPndoZXJlKCdpZHVzdWFyaW8nLHN0cnZhbChBdXRoOjp1c2VyKCktPmlkKSkKICAgICAgICAgICAgLT51cGRhdGUoWyd2YWxvcicgPT4gMF0pOwogICAgICAgIH0KCiAgICAgICAgLy8tLQoKICAgICAgICAkdXN1YXJpb3MgPSBEQjo6dGFibGUoJ3VzZXJzJyktPndoZXJlSW4oJ2lkdGlwbycsIFsnQURNJywnVkVOJywnVEVDJ10pLT5nZXQoKTsKICAgICAgICAvL2RkKCR1c3Vhcmlvcyk7CiAgICAgICAgLy8kdXN1YXJpb3MgPSBEQjo6dGFibGUoJ3VzZXJzJyktPndoZXJlKCdlc3RhZG8nLCAxKS0+Z2V0KCk7CgogICAgICAgIHJldHVybiB2aWV3KCdmb3Jtcy51c3Vhcmlvcy5sc3RVc3VhcmlvcycsIFsKICAgICAgICAgICAgICAgICAgICAndXN1YXJpb3MnICAgPT4gJHVzdWFyaW9zLAogICAgICAgICAgICAgICAgICAgICd2YWxpZGEnICAgICA9PiAkdmFsaWRhCiAgICAgICAgICAgICAgICBdKTsKICAgIH0KCgogICAgcHVibGljIGZ1bmN0aW9uIGNyZWF0ZSgpCiAgICB7CiAgICAgICAgJGVtcHJlc2EgPSBEQjo6dGFibGUoJ2VtcHJlc2EnKS0+d2hlcmUoJ2VzdGFkbycsMSktPmdldCgpOwogICAgICAgICR0aXBvX2RvY3VtZW50byA9IERCOjp0YWJsZSgnZG9jdW1lbnRvJykKICAgICAgICAgICAgLT5zZWxlY3QoJ2lkZG9jdW1lbnRvJywgJ2Rlc2NyaXBjaW9uJywgJ2RzY19jb3J0YScpCiAgICAgICAgICAgIC0+d2hlcmUoJ2VzdGFkbycsICcxJykKICAgICAgICAgICAgLT5nZXQoKTsKCiAgICAgICAgcmV0dXJuIHZpZXcoJ2Zvcm1zLnVzdWFyaW9zLmFkZFVzdWFyaW8nLFsKICAgICAgICAgICAgJ2VtcHJlc2EnICAgICAgICAgICA9PiAkZW1wcmVzYSwKICAgICAgICAgICAgJ3RpcG9fZG9jdW1lbnRvJyAgICA9PiAkdGlwb19kb2N1bWVudG8KICAgICAgICBdKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gc3RvcmUoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAvL2RkKCRyZXF1ZXN0KTsKICAgICAgICAkYXV0b3JpemEgPSBudWxsOwogICAgICAgICRydWxlcyA9IGFycmF5KCAgICAgCiAgICAgICAgICAgICdpZGVtcHJlc2EnICAgICA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnaWRkb2N1bWVudG8nICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ25yb19kb2N1bWVudG8nID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdub21icmUnICAgICAgICA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnYXBlbGxpZG9zJyAgICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ3VzdWFyaW8nICAgICAgID0+ICdyZXF1aXJlZHxzdHJpbmd8bWF4OjI1NScsCiAgICAgICAgICAgICdlbWFpbCcgICAgICAgICA9PiAncmVxdWlyZWR8c3RyaW5nfGVtYWlsfG1heDoyNTV8dW5pcXVlOnVzZXJzJywKICAgICAgICAgICAgJ3Bhc3N3b3JkJyAgICAgID0+ICdyZXF1aXJlZHxzdHJpbmd8bWluOjZ8Y29uZmlybWVkJywKICAgICAgICApOwoKICAgICAgICAkdmFsaWRhdG9yID0gVmFsaWRhdG9yOjptYWtlICggJHJlcXVlc3QtPmFsbCgpLCAkcnVsZXMgKTsKCiAgICAgICAgaWYgKCR2YWxpZGF0b3ItPmZhaWxzKCkpewogICAgICAgICAgICAkdmFyID0gJHZhbGlkYXRvci0+Z2V0TWVzc2FnZUJhZygpLT50b2FycmF5KCk7CiAgICAgICAgICAgIGFycmF5X3B1c2goJHZhciwgJ2Vycm9yJyk7ICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKCR2YXIpOwogICAgICAgIH0KICAgICAgICAvL2RkKCJ2YWxpZGFjaW9uIik7CiAgICAgICAgJGlkdXN1ID0gQXV0aDo6dXNlcigpLT5pZDsKICAgICAgICAkdmFsaWRhY2lvbiA9IERCOjp0YWJsZSgndmFsaWRhY2lvbicpLT53aGVyZSgnaWR1c3VhcmlvJywkaWR1c3UpLT5nZXQoKTsKICAgICAgICAkcGFyYW1ldHJvcyA9IERCOjp0YWJsZSgncGFyYW1ldHJvcycpLT53aGVyZUluKCd0aXBvX3BhcmFtZXRybycsWydDTElFTlRFUycsJ0ZBQ1RVUkFDSU9OJywnR0VORVJBTCddKS0+Z2V0KCk7CgogICAgICAgIGZvcmVhY2ggKCRwYXJhbWV0cm9zIGFzICRwYXJhbWV0cm8pIHsKICAgICAgICAgICAgaWYgKCRwYXJhbWV0cm8tPnBhcmFtZXRybyA9PSAnQVVUT1JJWkFDSU9OX0VTVEFETycpIHsKICAgICAgICAgICAgICAgICRhdXRvcml6YSA9ICRwYXJhbWV0cm8tPnZhbG9yOyAKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvL2RkKCRwYXJhbWV0cm9zKTsKICAgICAgICAvL2RkKCRhdXRvcml6YSxBdXRoOjp1c2VyKCktPmlkdGlwbyk7CiAgICAgICAgLy8kaWQgPSBjb3VudChEQjo6dGFibGUoJ3VzZXJzJyktPmdldCgpKSArIDE7CiAgICAgICAgaWYgKCRhdXRvcml6YSA9PSAnU0knIGFuZCBBdXRoOjp1c2VyKCktPmlkdGlwbyAhPSAnQURNJykgewogICAgICAgICAgICBEQjo6dGFibGUoJ3VzZXJzJykKICAgICAgICAgICAgLT5pbnNlcnQoWwogICAgICAgICAgICAgICAgJ2lkZW1wcmVzYScgICAgICAgICA9PiAkcmVxdWVzdC0+aWRlbXByZXNhLAogICAgICAgICAgICAgICAgJ25vbWJyZScgICAgICAgICAgICA9PiAkcmVxdWVzdC0+bm9tYnJlLAogICAgICAgICAgICAgICAgJ2FwZWxsaWRvcycgICAgICAgICA9PiAkcmVxdWVzdC0+YXBlbGxpZG9zLAogICAgICAgICAgICAgICAgJ2lkdGlwbycgICAgICAgICAgICA9PiAkcmVxdWVzdC0+aWR0aXBvLAogICAgICAgICAgICAgICAgJ2VzdGFkbycgICAgICAgICAgICA9PiAwLAogICAgICAgICAgICAgICAgJ2VtYWlsJyAgICAgICAgICAgICA9PiAkcmVxdWVzdC0+ZW1haWwsCiAgICAgICAgICAgICAgICAncGFzc3dvcmQnICAgICAgICAgID0+IEhhc2g6Om1ha2UoJHJlcXVlc3QtPnBhc3N3b3JkKSwKICAgICAgICAgICAgICAgICd1c3VhcmlvJyAgICAgICAgICAgPT4gJHJlcXVlc3QtPnVzdWFyaW8sCiAgICAgICAgICAgICAgICAnaWRkb2N1bWVudG8nICAgICAgID0+ICRyZXF1ZXN0LT5pZGRvY3VtZW50bywKICAgICAgICAgICAgICAgICducm9fZG9jdW1lbnRvJyAgICAgPT4gJHJlcXVlc3QtPm5yb19kb2N1bWVudG8sCiAgICAgICAgICAgICAgICAnY2FyZ28nICAgICAgICAgICAgID0+ICRyZXF1ZXN0LT5jYXJnbywKICAgICAgICAgICAgICAgICdhdmF0YXInICAgICAgICAgICAgPT4gbnVsbCwKICAgICAgICAgICAgICAgICd0ZWxlZm9ubycgICAgICAgICAgPT4gJHJlcXVlc3QtPnRlbGVmb25vLAogICAgICAgICAgICAgICAgJ2dsb3NhJyAgICAgICAgICAgICA9PiAkcmVxdWVzdC0+Z2xvc2EsCiAgICAgICAgICAgICAgICAnaWR1c3VhcmlvJyAgICAgICAgID0+IEF1dGg6OnVzZXIoKS0+aWQsCiAgICAgICAgICAgICAgICAnY3JlYXRlZF9hdCcgICAgICAgID0+IGRhdGUoJ1ktbS1kIGg6bTpzJykKICAgICAgICAgICAgXSk7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIERCOjp0YWJsZSgndXNlcnMnKQogICAgICAgICAgICAtPmluc2VydChbCiAgICAgICAgICAgICAgICAnaWRlbXByZXNhJyAgICAgICAgID0+ICRyZXF1ZXN0LT5pZGVtcHJlc2EsCiAgICAgICAgICAgICAgICAnbm9tYnJlJyAgICAgICAgICAgID0+ICRyZXF1ZXN0LT5ub21icmUsCiAgICAgICAgICAgICAgICAnYXBlbGxpZG9zJyAgICAgICAgID0+ICRyZXF1ZXN0LT5hcGVsbGlkb3MsCiAgICAgICAgICAgICAgICAnaWR0aXBvJyAgICAgICAgICAgID0+ICRyZXF1ZXN0LT5pZHRpcG8sCiAgICAgICAgICAgICAgICAnZXN0YWRvJyAgICAgICAgICAgID0+IDEsCiAgICAgICAgICAgICAgICAnZW1haWwnICAgICAgICAgICAgID0+ICRyZXF1ZXN0LT5lbWFpbCwKICAgICAgICAgICAgICAgICdwYXNzd29yZCcgICAgICAgICAgPT4gSGFzaDo6bWFrZSgkcmVxdWVzdC0+cGFzc3dvcmQpLAogICAgICAgICAgICAgICAgJ3VzdWFyaW8nICAgICAgICAgICA9PiAkcmVxdWVzdC0+dXN1YXJpbywKICAgICAgICAgICAgICAgICdpZGRvY3VtZW50bycgICAgICAgPT4gJHJlcXVlc3QtPmlkZG9jdW1lbnRvLAogICAgICAgICAgICAgICAgJ25yb19kb2N1bWVudG8nICAgICA9PiAkcmVxdWVzdC0+bnJvX2RvY3VtZW50bywKICAgICAgICAgICAgICAgICdjYXJnbycgICAgICAgICAgICAgPT4gJHJlcXVlc3QtPmNhcmdvLAogICAgICAgICAgICAgICAgJ2F2YXRhcicgICAgICAgICAgICA9PiBudWxsLAogICAgICAgICAgICAgICAgJ3RlbGVmb25vJyAgICAgICAgICA9PiAkcmVxdWVzdC0+dGVsZWZvbm8sCiAgICAgICAgICAgICAgICAnZ2xvc2EnICAgICAgICAgICAgID0+ICRyZXF1ZXN0LT5nbG9zYSwKICAgICAgICAgICAgICAgICdpZHVzdWFyaW8nICAgICAgICAgPT4gQXV0aDo6dXNlcigpLT5pZCwKICAgICAgICAgICAgICAgICdjcmVhdGVkX2F0JyAgICAgICAgPT4gZGF0ZSgnWS1tLWQgaDptOnMnKQogICAgICAgICAgICBdKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgCgogICAgICAgIGlmIChjb3VudCgkdmFsaWRhY2lvbikgPT09IDApIHsKICAgICAgICAgICAgREI6OnRhYmxlKCd2YWxpZGFjaW9uJykKICAgICAgICAgICAgLT5pbnNlcnQoWwogICAgICAgICAgICAgICAgJ2lkdXN1YXJpbycgPT4gJGlkdXN1LAogICAgICAgICAgICAgICAgJ3ZhbG9yJyAgICAgPT4gMQogICAgICAgICAgICBdKTsKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgREI6OnRhYmxlKCd2YWxpZGFjaW9uJykKICAgICAgICAgICAgLT53aGVyZSgnaWR1c3VhcmlvJyxzdHJ2YWwoJGlkdXN1KSkKICAgICAgICAgICAgLT51cGRhdGUoWyd2YWxvcicgPT4gMV0pOwogICAgICAgICAgICAKICAgICAgICB9CgogICAgICAgIHJldHVybiByZWRpcmVjdCgnL3VzdWFyaW9zJyk7CiAgICB9CgoKICAgIHB1YmxpYyBmdW5jdGlvbiBzaG93KCRpZCkKICAgIHsKICAgICAgICAkdXN1YXJpbyA9IERCOjp0YWJsZSgndXNlcnMnKQogICAgICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2lkJywkaWQpLT5nZXQoKTsKICAgICAgICAkZW1wcmVzYSA9IERCOjp0YWJsZSgnZW1wcmVzYScpLT53aGVyZSgnZXN0YWRvJywxKS0+Z2V0KCk7CiAgICAgICAgJHRpcG9fZG9jdW1lbnRvID0gREI6OnRhYmxlKCdkb2N1bWVudG8nKQogICAgICAgICAgICAtPnNlbGVjdCgnaWRkb2N1bWVudG8nLCAnZGVzY3JpcGNpb24nLCAnZHNjX2NvcnRhJykKICAgICAgICAgICAgLT53aGVyZSgnZXN0YWRvJywgJzEnKQogICAgICAgICAgICAtPmdldCgpOwoKICAgICAgICByZXR1cm4gdmlldygnZm9ybXMudXN1YXJpb3MudXBkVXN1YXJpbycsWwogICAgICAgICAgICAndXN1YXJpbycgICAgICAgICAgID0+ICR1c3VhcmlvLAogICAgICAgICAgICAnZW1wcmVzYScgICAgICAgICAgID0+ICRlbXByZXNhLAogICAgICAgICAgICAndGlwb19kb2N1bWVudG8nICAgID0+ICR0aXBvX2RvY3VtZW50bwogICAgICAgIF0pOwogICAgfQoKCiAgICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZShSZXF1ZXN0ICRyZXF1ZXN0KQogICAgeyAKICAgICAgICAgJHJ1bGVzID0gYXJyYXkoICAgICAKICAgICAgICAgICAgJ2lkZW1wcmVzYScgICAgID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICducm9fZG9jdW1lbnRvJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnbm9tYnJlJyAgICAgICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2FwZWxsaWRvcycgICAgID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICd1c3VhcmlvJyAgICAgICA9PiAncmVxdWlyZWR8c3RyaW5nfG1heDoyNTUnLAogICAgICAgICAgICAnZW1haWwnICAgICAgICAgPT4gJ3JlcXVpcmVkfHN0cmluZ3xlbWFpbHxtYXg6MjU1JywKICAgICAgICApOwoKICAgICAgICAkdmFsaWRhdG9yID0gVmFsaWRhdG9yOjptYWtlICggJHJlcXVlc3QtPmFsbCgpLCAkcnVsZXMgKTsKCiAgICAgICAgaWYgKCR2YWxpZGF0b3ItPmZhaWxzKCkpewogICAgICAgICAgICAkdmFyID0gJHZhbGlkYXRvci0+Z2V0TWVzc2FnZUJhZygpLT50b2FycmF5KCk7CiAgICAgICAgICAgIGFycmF5X3B1c2goJHZhciwgJ2Vycm9yJyk7ICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKCR2YXIpOwogICAgICAgIH0KICAgICAgICAKCiAgICAgICAgREI6OnRhYmxlKCd1c2VycycpCiAgICAgICAgLT53aGVyZSgnaWQnLHN0cnZhbCgkcmVxdWVzdC0+aWQpKQogICAgICAgIC0+dXBkYXRlKFsKICAgICAgICAgICAgJ2lkZW1wcmVzYScgICAgICAgICA9PiAkcmVxdWVzdC0+aWRlbXByZXNhLAogICAgICAgICAgICAnaWR0aXBvJyAgICAgICAgICAgID0+ICRyZXF1ZXN0LT5pZHRpcG8sCiAgICAgICAgICAgICdub21icmUnCQkJPT4gJHJlcXVlc3QtPm5vbWJyZSwKICAgICAgICAgICAgJ2FwZWxsaWRvcycgICAgICAgICA9PiAkcmVxdWVzdC0+YXBlbGxpZG9zLAogICAgICAgICAgICAnZW1haWwnICAgICAgICAgICAgCT0+ICRyZXF1ZXN0LT5lbWFpbCwKICAgICAgICAgICAgJ3VzdWFyaW8nICAgICAgICAgCT0+ICRyZXF1ZXN0LT51c3VhcmlvLAogICAgICAgICAgICAnaWRkb2N1bWVudG8nICAgICAgID0+ICRyZXF1ZXN0LT5pZGRvY3VtZW50bywKICAgICAgICAgICAgJ25yb19kb2N1bWVudG8nICAgICA9PiAkcmVxdWVzdC0+bnJvX2RvY3VtZW50bywKICAgICAgICAgICAgJ2NhcmdvJyAgICAgICAgCQk9PiAkcmVxdWVzdC0+Y2FyZ28sCiAgICAgICAgICAgICdhdmF0YXInICAgICAgICAgICAgPT4gbnVsbCwKICAgICAgICAgICAgJ3RlbGVmb25vJyAgICAJCT0+ICRyZXF1ZXN0LT50ZWxlZm9ubywKICAgICAgICAgICAgJ2dsb3NhJyAgICAgICAgICAgICA9PiAkcmVxdWVzdC0+Z2xvc2EgCiAgICAgICAgXSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAkaWR1c3UgPSBBdXRoOjp1c2VyKCktPmlkOwogICAgICAgICR2YWxpZGFjaW9uID0gREI6OnRhYmxlKCd2YWxpZGFjaW9uJyktPndoZXJlKCdpZHVzdWFyaW8nLCRpZHVzdSktPmdldCgpOwoKICAgICAgICAKICAgICAgICBpZiAoQXV0aDo6dXNlcigpLT5pZHRpcG8gPT0gJ0FETScpIHsKICAgICAgICAgICAgaWYgKGNvdW50KCR2YWxpZGFjaW9uKSA+IDApIHsgICAgICAgICAgIAogICAgICAgICAgICAgICAgREI6OnRhYmxlKCd2YWxpZGFjaW9uJykKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2lkdXN1YXJpbycsc3RydmFsKCRpZHVzdSkpCiAgICAgICAgICAgICAgICAtPnVwZGF0ZShbJ3ZhbG9yJyA9PiAyXSk7ICAKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KCcvdXN1YXJpb3MnKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZGVzdHJveSgkaWQpCiAgICB7ICAgICAgICAKICAgIAkvL2RkKCRpZCk7CiAgICAgICAgREI6OnRhYmxlKCd1c2VycycpCiAgICAgICAgICAgIC0+d2hlcmUoJ2lkJywkaWQpLT5kZWxldGUoKTsKCiAgICAgICAgJGlkdXN1ID0gQXV0aDo6dXNlcigpLT5pZDsKICAgICAgICAkdmFsaWRhY2lvbiA9IERCOjp0YWJsZSgndmFsaWRhY2lvbicpLT53aGVyZSgnaWR1c3VhcmlvJywkaWR1c3UpLT5nZXQoKTsKCiAgICAgICAgaWYgKGNvdW50KCR2YWxpZGFjaW9uKSA9PT0gMCkgewogICAgICAgICAgICBEQjo6dGFibGUoJ3ZhbGlkYWNpb24nKQogICAgICAgICAgICAtPmluc2VydChbCiAgICAgICAgICAgICAgICAnaWR1c3VhcmlvJyA9PiAkaWR1c3UsCiAgICAgICAgICAgICAgICAndmFsb3InICAgICA9PiAzCiAgICAgICAgICAgIF0pOwogICAgICAgIH1lbHNlewogICAgICAgICAgICBEQjo6dGFibGUoJ3ZhbGlkYWNpb24nKQogICAgICAgICAgICAtPndoZXJlKCdpZHVzdWFyaW8nLHN0cnZhbCgkaWR1c3UpKQogICAgICAgICAgICAtPnVwZGF0ZShbJ3ZhbG9yJyA9PiAzXSk7CiAgICAgICAgICAgIAogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KCcvdXN1YXJpb3MnKTsKICAgIH0KCgogICAgcHVibGljIGZ1bmN0aW9uIGRpc2FibGVkKFJlcXVlc3QgJHJlcXVlc3QpCiAgICB7CiAgICAgICAgREI6OnRhYmxlKCd1c2VycycpCiAgICAgICAgICAgIC0+d2hlcmUoJ2lkJywkcmVxdWVzdC0+aWQpCiAgICAgICAgICAgIC0+dXBkYXRlKFsKICAgICAgICAgICAgICAgICdlc3RhZG8nICAgID0+IDAKICAgICAgICAgICAgXSk7CgogICAgICAgICR1c2VycyA9IERCOjp0YWJsZSgndXNlcnMnKS0+d2hlcmUoJ2lkJywkcmVxdWVzdC0+aWQpLT5nZXQoKTsKICAgICAgICAkY29sbGVjdGlvbiA9IENvbGxlY3Rpb246Om1ha2UoJHVzZXJzKTsKICAgICAgICAgICAgICAgIAogICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKCRjb2xsZWN0aW9uLT50b0pzb24oKSk7ICAgCiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGhhYmlsaXRhcihSZXF1ZXN0ICRyZXF1ZXN0KQogICAgewogICAgICAgIERCOjp0YWJsZSgndXNlcnMnKQogICAgICAgICAgICAtPndoZXJlKCdpZCcsc3RydmFsKCRyZXF1ZXN0LT5pZCkpCiAgICAgICAgICAgIC0+dXBkYXRlKFsKICAgICAgICAgICAgICAgICdlc3RhZG8nICAgID0+IDEKICAgICAgICAgICAgXSk7CgogICAgICAgICR1c2VycyA9IERCOjp0YWJsZSgndXNlcnMnKS0+d2hlcmUoJ2lkJywkcmVxdWVzdC0+aWQpLT5nZXQoKTsKICAgICAgICAkY29sbGVjdGlvbiA9IENvbGxlY3Rpb246Om1ha2UoJHVzZXJzKTsKICAgICAgICAgICAgICAgIAogICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKCRjb2xsZWN0aW9uLT50b0pzb24oKSk7ICAgCiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHVwZENvbnRyYShSZXF1ZXN0ICRyZXF1ZXN0KQogICAgeyAgICAgICAgCiAgICAgICAgLy9kZCgkcmVxdWVzdCk7CiAgICAgICAgJHJ1bGVzID0gYXJyYXkoICAgICAKICAgICAgICAgICAgJ2NvbnRyYScgICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2NvbnRyYTInICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2NvbnRyYTMnICAgPT4gJ3JlcXVpcmVkJwogICAgICAgICk7CgogICAgICAgICR2YWxpZGF0b3IgPSBWYWxpZGF0b3I6Om1ha2UgKCAkcmVxdWVzdC0+YWxsKCksICRydWxlcyApOwoKICAgICAgICBpZiAoJHZhbGlkYXRvci0+ZmFpbHMoKSl7CiAgICAgICAgICAgICR2YXIgPSAkdmFsaWRhdG9yLT5nZXRNZXNzYWdlQmFnKCktPnRvYXJyYXkoKTsKICAgICAgICAgICAgYXJyYXlfcHVzaCgkdmFyLCAnZXJyb3InKTsgICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oJHZhcik7CiAgICAgICAgfQoKICAgICAgICAkY29udHJhID0gbnVsbDsKICAgICAgICAkdXNlciA9IERCOjp0YWJsZSgndXNlcnMnKS0+d2hlcmUoJ2lkJyxzdHJ2YWwoJHJlcXVlc3QtPmlkKSktPmdldCgpOwoKICAgICAgICBmb3JlYWNoICgkdXNlciBhcyAkdmFsKSB7CiAgICAgICAgICAgICRjb250cmEgPSAkdmFsLT5wYXNzd29yZDsKICAgICAgICB9CgogICAgICAgIGlmKCFIYXNoOjpjaGVjaygkcmVxdWVzdC0+Y29udHJhLCAkY29udHJhKSl7CiAgICAgICAgICAgICR2YXIgPSAkdmFsaWRhdG9yLT5nZXRNZXNzYWdlQmFnKCktPnRvYXJyYXkoKTsKICAgICAgICAgICAgYXJyYXlfcHVzaCgkdmFyLCAnQkFEX0NPTlRSQScpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbigkdmFyKTsKICAgICAgICB9CgogICAgICAgIGlmICgkcmVxdWVzdC0+Y29udHJhMiAhPSAkcmVxdWVzdC0+Y29udHJhMykgewogICAgICAgICAgICAkdmFyID0gJHZhbGlkYXRvci0+Z2V0TWVzc2FnZUJhZygpLT50b2FycmF5KCk7CiAgICAgICAgICAgIGFycmF5X3B1c2goJHZhciwgJ0JBRF9DT05UUkEyJyk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKCR2YXIpOwogICAgICAgIH0KCiAgICAgICAgREI6OnRhYmxlKCd1c2VycycpCiAgICAgICAgLT53aGVyZSgnaWQnLHN0cnZhbCgkcmVxdWVzdC0+aWQpKQogICAgICAgIC0+dXBkYXRlKFsKICAgICAgICAgICAgJ3Bhc3N3b3JkJyAgPT4gSGFzaDo6bWFrZSgkcmVxdWVzdC0+Y29udHJhMiksCiAgICAgICAgXSk7CgogICAgICAgICR0aXBvID0gREI6OnRhYmxlKCd0aXBvJyktPmdldCgpOwoKICAgICAgICAkY29sbGVjdGlvbiA9IENvbGxlY3Rpb246Om1ha2UoJHRpcG8pOwogICAgICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oJGNvbGxlY3Rpb24tPnRvSnNvbigpKTsgICAKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gdmVyaWZpY2FySUQoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAvL2RkKCRyZXF1ZXN0KTsKICAgICAgICAkdXN1YXJpbyA9IERCOjp0YWJsZSgndXNlcnMnKS0+d2hlcmUoJ25yb19kb2N1bWVudG8nLCAkcmVxdWVzdC0+Y29kaWdvKS0+Z2V0KCk7CgogICAgICAgIGlmKGNvdW50KCR1c3VhcmlvKSA+IDApewogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihhcnJheSgnZXJyb3JzJz0+ICdFWElTVEUnKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgICRjb2xsZWN0aW9uID0gQ29sbGVjdGlvbjo6bWFrZSgkdXN1YXJpbyk7CiAgICAgICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbigkY29sbGVjdGlvbi0+dG9Kc29uKCkpOyAgIAogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiB2ZXJpZmljYXJVc3VhcmlvKFJlcXVlc3QgJHJlcXVlc3QpCiAgICB7CiAgICAgICAgLy9kZCgkcmVxdWVzdCk7CiAgICAgICAgJHVzdWFyaW8gPSBEQjo6dGFibGUoJ3VzZXJzJyktPndoZXJlKCd1c3VhcmlvJywgJHJlcXVlc3QtPmNvZGlnbyktPmdldCgpOwoKICAgICAgICBpZihjb3VudCgkdXN1YXJpbykgPiAwKXsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oYXJyYXkoJ2Vycm9ycyc9PiAnRVhJU1RFJykpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAkY29sbGVjdGlvbiA9IENvbGxlY3Rpb246Om1ha2UoJHVzdWFyaW8pOyAgCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oJGNvbGxlY3Rpb24tPnRvSnNvbigpKTsgICAKICAgIH0KCi8vLyAgZ2VzdGlvbiBkZSB1c3VhcmlvcyB0cmFiYWphZG9yZXMKICAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXhUcmFiYWphZG9yZXMoKQogICAgewogICAgICAgIC8vIGRkKCdsbGVnbycpOwogICAgICAgICR2YWxpZGEgPSAwOyAKICAgICAgICAvLy0tIFZhbGlkYWNpw7NuIHBhcmEgbW9zdHJhciBtZW5zYWplcyBhbCByZWFsaXphciB1biBDUlVECiAgICAgICAgJHZhbGlkYWNpb24gPSBEQjo6dGFibGUoJ3ZhbGlkYWNpb24nKQogICAgICAgICAgICAgICAgICAgICAgICAtPnNlbGVjdCgndmFsb3InKQogICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlKCdpZHVzdWFyaW8nLEF1dGg6OnVzZXIoKS0+aWQpLT5nZXQoKTsKCiAgICAgICAgZm9yZWFjaCAoJHZhbGlkYWNpb24gYXMgJHZhbCkgewogICAgICAgICAgICAkdmFsaWRhID0gJHZhbC0+dmFsb3I7CiAgICAgICAgfQogICAgICAgIGlmICgkdmFsaWRhID4gMCkgewogICAgICAgICAgICBEQjo6dGFibGUoJ3ZhbGlkYWNpb24nKQogICAgICAgICAgICAtPndoZXJlKCdpZHVzdWFyaW8nLHN0cnZhbChBdXRoOjp1c2VyKCktPmlkKSkKICAgICAgICAgICAgLT51cGRhdGUoWyd2YWxvcicgPT4gMF0pOwogICAgICAgIH0KCiAgICAgICAgLy8tLQoKICAgICAgICAkdXN1YXJpb3MgPSBEQjo6dGFibGUoJ3VzZXJzJyktPndoZXJlKCdpZHRpcG8nLCdUUkEnICktPmdldCgpOwogICAgICAgIC8vZGQoJHVzdWFyaW9zKTsKICAgICAgICAvLyR1c3VhcmlvcyA9IERCOjp0YWJsZSgndXNlcnMnKS0+d2hlcmUoJ2VzdGFkbycsIDEpLT5nZXQoKTsKCiAgICAgICAgcmV0dXJuIHZpZXcoJ2Zvcm1zLnRyYWJhamFkb3Jlcy5sc3RVc3VhcmlvcycsIFsKICAgICAgICAgICAgICAgICAgICAndXN1YXJpb3MnICAgPT4gJHVzdWFyaW9zLAogICAgICAgICAgICAgICAgICAgICd2YWxpZGEnICAgICA9PiAkdmFsaWRhCiAgICAgICAgICAgICAgICBdKTsKICAgIH0KICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGVUcmFiYWphZG9yKCkKICAgIHsKICAgICAgICAkZW1wcmVzYSA9IERCOjp0YWJsZSgnZW1wcmVzYScpLT53aGVyZSgnZXN0YWRvJywxKS0+Z2V0KCk7CiAgICAgICAgJHNpdHVhY2lvbl9sYWJvcmFsID0gREI6OnRhYmxlKCdzaXR1YWNpb25fbGFib3JhbCcpLT53aGVyZSgnZXN0YWRvJywxKS0+Z2V0KCk7CiAgICAgICAgJHJlZ2ltZW5fbGFib3JhbCA9IERCOjp0YWJsZSgncmVnaW1lbl9sYWJvcmFsJyktPndoZXJlKCdlc3RhZG8nLDEpLT5nZXQoKTsKICAgICAgICAkY2FyZ29fbGFib3JhbCA9IERCOjp0YWJsZSgnY2FyZ29fbGFib3JhbCcpLT53aGVyZSgnZXN0YWRvJywxKS0+Z2V0KCk7CiAgICAgICAgJGFyZWFfbGFib3JhbCA9IERCOjp0YWJsZSgnYXJlYV9sYWJvcmFsJyktPndoZXJlKCdlc3RhZG8nLDEpLT5nZXQoKTsKICAgICAgICAkdGlwb19kb2N1bWVudG8gPSBEQjo6dGFibGUoJ2RvY3VtZW50bycpCiAgICAgICAgICAgIC0+c2VsZWN0KCdpZGRvY3VtZW50bycsICdkZXNjcmlwY2lvbicsICdkc2NfY29ydGEnKQogICAgICAgICAgICAtPndoZXJlKCdlc3RhZG8nLCAnMScpCiAgICAgICAgICAgIC0+Z2V0KCk7CiAgICAgICAgICAgIC8vICBkZCggJGNhcmdvX2xhYm9yYWwpOwoKICAgICAgICByZXR1cm4gdmlldygnZm9ybXMudHJhYmFqYWRvcmVzLmFkZFVzdWFyaW8nLFsKICAgICAgICAgICAgJ2VtcHJlc2EnICAgICAgICAgICA9PiAkZW1wcmVzYSwKICAgICAgICAgICAgJ3RpcG9fZG9jdW1lbnRvJyAgICA9PiAkdGlwb19kb2N1bWVudG8sCiAgICAgICAgICAgICdzaXR1YWNpb25fbGFib3JhbCcgICAgPT4gJHNpdHVhY2lvbl9sYWJvcmFsLAogICAgICAgICAgICAncmVnaW1lbl9sYWJvcmFsJyAgICA9PiAkcmVnaW1lbl9sYWJvcmFsLAogICAgICAgICAgICAnY2FyZ29fbGFib3JhbCcgICAgPT4gJGNhcmdvX2xhYm9yYWwsCiAgICAgICAgICAgICdhcmVhX2xhYm9yYWwnICAgID0+ICRhcmVhX2xhYm9yYWwsCiAgICAgICAgXSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBmdW5jdGlvbiBzdG9yZVVzdWFyaW9UcmFiYWphZG9yKFJlcXVlc3QgJHJlcXVlc3QpCiAgICB7CiAgICAgICAgLy8gIGRkKCRyZXF1ZXN0KTsKICAgICAgICAkYXV0b3JpemEgPSBudWxsOwogICAgICAgICRydWxlcyA9IGFycmF5KCAgICAgCiAgICAgICAgICAgICdpZGVtcHJlc2EnICAgICAgICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2lkZG9jdW1lbnRvJyAgICAgICA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnbnJvX2RvY3VtZW50bycgICAgID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdub21icmUnICAgICAgICAgICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2lkU2V4bycgICAgICAgICAgICA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnYXBlbGxpZG9zJyAgICAgICAgID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdzaXR1YWNpb25MYWJvcmFsJyAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ3JlZ2ltZW5MYWJvcmFsJyAgICA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnY2FyZ28nICAgICAgICAgICAgID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdhcmVhTGFib3JhbCcgICAgICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ3RpcG9UcmFiYWphZG9yJyAgICA9PiAncmVxdWlyZWQnLCAKICAgICAgICAgICAgJ2VtYWlsJyAgICAgICAgICAgICA9PiAncmVxdWlyZWR8c3RyaW5nfGVtYWlsfG1heDoyNTV8dW5pcXVlOnVzZXJzJywKICAgICAgICAgICAgLy8gJ3Bhc3N3b3JkJyAgICAgID0+ICdyZXF1aXJlZHxzdHJpbmd8bWluOjZ8Y29uZmlybWVkJywKICAgICAgICApOwoKICAgICAgICAkdmFsaWRhdG9yID0gVmFsaWRhdG9yOjptYWtlICggJHJlcXVlc3QtPmFsbCgpLCAkcnVsZXMgKTsKCiAgICAgICAgaWYgKCR2YWxpZGF0b3ItPmZhaWxzKCkpewogICAgICAgICAgICAkdmFyID0gJHZhbGlkYXRvci0+Z2V0TWVzc2FnZUJhZygpLT50b2FycmF5KCk7CiAgICAgICAgICAgIGFycmF5X3B1c2goJHZhciwgJ2Vycm9yJyk7ICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKCR2YXIpOwogICAgICAgIH0KICAgICAgICAvL2RkKCJ2YWxpZGFjaW9uIik7CiAgICAgICAgJGlkdXN1ID0gQXV0aDo6dXNlcigpLT5pZDsKICAgICAgICAkdmFsaWRhY2lvbiA9IERCOjp0YWJsZSgndmFsaWRhY2lvbicpLT53aGVyZSgnaWR1c3VhcmlvJywkaWR1c3UpLT5nZXQoKTsKICAgICAgICAkcGFyYW1ldHJvcyA9IERCOjp0YWJsZSgncGFyYW1ldHJvcycpLT53aGVyZUluKCd0aXBvX3BhcmFtZXRybycsWydDTElFTlRFUycsJ0ZBQ1RVUkFDSU9OJywnR0VORVJBTCddKS0+Z2V0KCk7CgogICAgICAgIGZvcmVhY2ggKCRwYXJhbWV0cm9zIGFzICRwYXJhbWV0cm8pIHsKICAgICAgICAgICAgaWYgKCRwYXJhbWV0cm8tPnBhcmFtZXRybyA9PSAnQVVUT1JJWkFDSU9OX0VTVEFETycpIHsKICAgICAgICAgICAgICAgICRhdXRvcml6YSA9ICRwYXJhbWV0cm8tPnZhbG9yOyAKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvL2RkKCRwYXJhbWV0cm9zKTsKICAgICAgICAvL2RkKCRhdXRvcml6YSxBdXRoOjp1c2VyKCktPmlkdGlwbyk7CiAgICAgICAgLy8kaWQgPSBjb3VudChEQjo6dGFibGUoJ3VzZXJzJyktPmdldCgpKSArIDE7CiAgICAgICAgaWYgKCRhdXRvcml6YSA9PSAnU0knIGFuZCBBdXRoOjp1c2VyKCktPmlkdGlwbyAhPSAnQURNJykgewogICAgICAgICAgICBEQjo6dGFibGUoJ3VzZXJzJykKICAgICAgICAgICAgLT5pbnNlcnQoWwogICAgICAgICAgICAgICAgJ2lkZW1wcmVzYScgICAgICAgICA9PiAkcmVxdWVzdC0+aWRlbXByZXNhLAogICAgICAgICAgICAgICAgJ25vbWJyZScgICAgICAgICAgICA9PiAkcmVxdWVzdC0+bm9tYnJlLAogICAgICAgICAgICAgICAgJ2FwZWxsaWRvcycgICAgICAgICA9PiAkcmVxdWVzdC0+YXBlbGxpZG9zLAogICAgICAgICAgICAgICAgJ2lkdGlwbycgICAgICAgICAgICA9PiAkcmVxdWVzdC0+dGlwb1RyYWJhamFkb3IsCiAgICAgICAgICAgICAgICAnZXN0YWRvJyAgICAgICAgICAgID0+IDAsCiAgICAgICAgICAgICAgICAnZW1haWwnICAgICAgICAgICAgID0+ICRyZXF1ZXN0LT5lbWFpbCwgIAogICAgICAgICAgICAgICAgJ2lkZG9jdW1lbnRvJyAgICAgICA9PiAkcmVxdWVzdC0+aWRkb2N1bWVudG8sCiAgICAgICAgICAgICAgICAnbnJvX2RvY3VtZW50bycgICAgID0+ICRyZXF1ZXN0LT5ucm9fZG9jdW1lbnRvLAogICAgICAgICAgICAgICAgJ2RpcmVjY2lvbicgICAgICAgICA9PiAkcmVxdWVzdC0+ZGlyZWNjaW9uLAogICAgICAgICAgICAgICAgJ2NhcmdvJyAgICAgICAgICAgICA9PiAkcmVxdWVzdC0+Y2FyZ28sCiAgICAgICAgICAgICAgICAnYXZhdGFyJyAgICAgICAgICAgID0+IG51bGwsCiAgICAgICAgICAgICAgICAndGVsZWZvbm8nICAgICAgICAgID0+ICRyZXF1ZXN0LT50ZWxlZm9ubywKICAgICAgICAgICAgICAgICdnbG9zYScgICAgICAgICAgICAgPT4gJHJlcXVlc3QtPmdsb3NhLAogICAgICAgICAgICAgICAgJ2lkdXN1YXJpbycgICAgICAgICA9PiBBdXRoOjp1c2VyKCktPmlkLAogICAgICAgICAgICAgICAgJ2NyZWF0ZWRfYXQnICAgICAgICA9PiBkYXRlKCdZLW0tZCBoOm06cycpCiAgICAgICAgICAgIF0pOwogICAgICAgIH1lbHNlewogICAgICAgICAgICBEQjo6dGFibGUoJ3VzZXJzJykKICAgICAgICAgICAgLT5pbnNlcnQoWwogICAgICAgICAgICAgICAgJ2lkZW1wcmVzYScgICAgICAgICA9PiAkcmVxdWVzdC0+aWRlbXByZXNhLAogICAgICAgICAgICAgICAgJ25vbWJyZScgICAgICAgICAgICA9PiAkcmVxdWVzdC0+bm9tYnJlLAogICAgICAgICAgICAgICAgJ2FwZWxsaWRvcycgICAgICAgICA9PiAkcmVxdWVzdC0+YXBlbGxpZG9zLAogICAgICAgICAgICAgICAgJ2lkdGlwbycgICAgICAgICAgICA9PiAkcmVxdWVzdC0+dGlwb1RyYWJhamFkb3IsCiAgICAgICAgICAgICAgICAnZXN0YWRvJyAgICAgICAgICAgID0+IDEsCiAgICAgICAgICAgICAgICAnZW1haWwnICAgICAgICAgICAgID0+ICRyZXF1ZXN0LT5lbWFpbCwKICAgICAgICAgICAgICAgICdwYXNzd29yZCcgICAgICAgICAgPT4gSGFzaDo6bWFrZSgiMTIzNDU2IiksCiAgICAgICAgICAgICAgICAndXN1YXJpbycgICAgICAgICAgID0+ICRyZXF1ZXN0LT5ucm9fZG9jdW1lbnRvLAogICAgICAgICAgICAgICAgJ2lkZG9jdW1lbnRvJyAgICAgICA9PiBpbnR2YWwoJHJlcXVlc3QtPmlkZG9jdW1lbnRvKSwKICAgICAgICAgICAgICAgICducm9fZG9jdW1lbnRvJyAgICAgPT4gJHJlcXVlc3QtPm5yb19kb2N1bWVudG8sCiAgICAgICAgICAgICAgICAnY2FyZ28nICAgICAgICAgICAgID0+ICRyZXF1ZXN0LT5jYXJnbywKICAgICAgICAgICAgICAgICdkaXJlY2Npb24nICAgICAgICAgPT4gJHJlcXVlc3QtPmRpcmVjY2lvbiwKICAgICAgICAgICAgICAgICdhdmF0YXInICAgICAgICAgICAgPT4gbnVsbCwgCiAgICAgICAgICAgICAgICAndGVsZWZvbm8nICAgICAgICAgID0+ICRyZXF1ZXN0LT50ZWxlZm9ubywKICAgICAgICAgICAgICAgICdnbG9zYScgICAgICAgICAgICAgPT4gJHJlcXVlc3QtPmdsb3NhLAogICAgICAgICAgICAgICAgJ2lkdXN1YXJpbycgICAgICAgICA9PiBBdXRoOjp1c2VyKCktPmlkLAogICAgICAgICAgICAgICAgJ2FyZWFfdHJhYmFqYWRvcicgICA9PiAkcmVxdWVzdC0+YXJlYUxhYm9yYWwsCiAgICAgICAgICAgICAgICAnc2l0dWFjaW9uX2xhYm9yYWwnID0+ICRyZXF1ZXN0LT5zaXR1YWNpb25MYWJvcmFsLCAgCiAgICAgICAgICAgICAgICAncmVnaW1lbl9sYWJvcmFsJyAgID0+ICRyZXF1ZXN0LT5yZWdpbWVuTGFib3JhbCwKICAgICAgICAgICAgICAgICdTRVhPJyAgICAgICAgICAgICA9PiAkcmVxdWVzdC0+aWRTZXhvLAogICAgICAgICAgICAgICAgJ2NyZWF0ZWRfYXQnICAgICAgICA9PiBkYXRlKCdZLW0tZCBoOm06cycpCiAgICAgICAgICAgIF0pOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAKCiAgICAgICAgaWYgKGNvdW50KCR2YWxpZGFjaW9uKSA9PT0gMCkgewogICAgICAgICAgICBEQjo6dGFibGUoJ3ZhbGlkYWNpb24nKQogICAgICAgICAgICAtPmluc2VydChbCiAgICAgICAgICAgICAgICAnaWR1c3VhcmlvJyA9PiAkaWR1c3UsCiAgICAgICAgICAgICAgICAndmFsb3InICAgICA9PiAxCiAgICAgICAgICAgIF0pOwogICAgICAgIH1lbHNlewogICAgICAgICAgICBEQjo6dGFibGUoJ3ZhbGlkYWNpb24nKQogICAgICAgICAgICAtPndoZXJlKCdpZHVzdWFyaW8nLHN0cnZhbCgkaWR1c3UpKQogICAgICAgICAgICAtPnVwZGF0ZShbJ3ZhbG9yJyA9PiAxXSk7CiAgICAgICAgICAgIAogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KCcvdHJhYmFqYWRvcmVzJyk7CiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gc2hvd1VzdWFyaW9UcmFiamFkb3IoJGlkKQogICAgewogICAgICAgICR1c3VhcmlvID0gREI6OnRhYmxlKCd1c2VycycpCiAgICAgICAgICAgICAgICAgICAgLT53aGVyZSgnaWQnLCRpZCktPmdldCgpOwogICAgICAgICRlbXByZXNhID0gREI6OnRhYmxlKCdlbXByZXNhJyktPndoZXJlKCdlc3RhZG8nLDEpLT5nZXQoKTsKICAgICAgICAkc2l0dWFjaW9uX2xhYm9yYWwgPSBEQjo6dGFibGUoJ3NpdHVhY2lvbl9sYWJvcmFsJyktPndoZXJlKCdlc3RhZG8nLDEpLT5nZXQoKTsKICAgICAgICAkcmVnaW1lbl9sYWJvcmFsID0gREI6OnRhYmxlKCdyZWdpbWVuX2xhYm9yYWwnKS0+d2hlcmUoJ2VzdGFkbycsMSktPmdldCgpOwogICAgICAgICRjYXJnb19sYWJvcmFsID0gREI6OnRhYmxlKCdjYXJnb19sYWJvcmFsJyktPndoZXJlKCdlc3RhZG8nLDEpLT5nZXQoKTsKICAgICAgICAkYXJlYV9sYWJvcmFsID0gREI6OnRhYmxlKCdhcmVhX2xhYm9yYWwnKS0+d2hlcmUoJ2VzdGFkbycsMSktPmdldCgpOwogICAgICAgICR0aXBvX2RvY3VtZW50byA9IERCOjp0YWJsZSgnZG9jdW1lbnRvJykKICAgICAgICAgICAgLT5zZWxlY3QoJ2lkZG9jdW1lbnRvJywgJ2Rlc2NyaXBjaW9uJywgJ2RzY19jb3J0YScpCiAgICAgICAgICAgIC0+d2hlcmUoJ2VzdGFkbycsICcxJykKICAgICAgICAgICAgLT5nZXQoKTsKCiAgICAgICAgcmV0dXJuIHZpZXcoJ2Zvcm1zLnRyYWJhamFkb3Jlcy51cGRVc3VhcmlvJyxbCiAgICAgICAgICAgICd1c3VhcmlvJyAgICAgICAgICAgPT4gJHVzdWFyaW8sCiAgICAgICAgICAgICdlbXByZXNhJyAgICAgICAgICAgPT4gJGVtcHJlc2EsCiAgICAgICAgICAgICdzaXR1YWNpb25fbGFib3JhbCcgICAgPT4gJHNpdHVhY2lvbl9sYWJvcmFsLAogICAgICAgICAgICAncmVnaW1lbl9sYWJvcmFsJyAgICA9PiAkcmVnaW1lbl9sYWJvcmFsLAogICAgICAgICAgICAnY2FyZ29fbGFib3JhbCcgICAgPT4gJGNhcmdvX2xhYm9yYWwsCiAgICAgICAgICAgICdhcmVhX2xhYm9yYWwnICAgID0+ICRhcmVhX2xhYm9yYWwsCiAgICAgICAgICAgICd0aXBvX2RvY3VtZW50bycgICAgPT4gJHRpcG9fZG9jdW1lbnRvCiAgICAgICAgXSk7CiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gdXBkYXRlVXN1YXJpb1RyYWJhamFkb3IoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsgCiAgICAgICAgLy8gZGQoJHJlcXVlc3QpOwogICAgICAgICAkcnVsZXMgPSBhcnJheSggICAgIAogICAgICAgICAgICAgJ2lkZW1wcmVzYScgICAgICAgICA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnaWRkb2N1bWVudG8nICAgICAgID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICducm9fZG9jdW1lbnRvJyAgICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ25vbWJyZScgICAgICAgICAgICA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnaWRTZXhvJyAgICAgICAgICAgID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdhcGVsbGlkb3MnICAgICAgICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ3NpdHVhY2lvbkxhYm9yYWwnICA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAncmVnaW1lbkxhYm9yYWwnICAgID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdjYXJnbycgICAgICAgICAgICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2FyZWFMYWJvcmFsJyAgICAgICAgICAgICA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAndGlwb1RyYWJhamFkb3InICAgID0+ICdyZXF1aXJlZCcsICAKICAgICAgICApOwoKICAgICAgICAkdmFsaWRhdG9yID0gVmFsaWRhdG9yOjptYWtlICggJHJlcXVlc3QtPmFsbCgpLCAkcnVsZXMgKTsKCiAgICAgICAgaWYgKCR2YWxpZGF0b3ItPmZhaWxzKCkpewogICAgICAgICAgICAkdmFyID0gJHZhbGlkYXRvci0+Z2V0TWVzc2FnZUJhZygpLT50b2FycmF5KCk7CiAgICAgICAgICAgIGFycmF5X3B1c2goJHZhciwgJ2Vycm9yJyk7ICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKCR2YXIpOwogICAgICAgIH0KICAgICAgICAKCiAgICAgICAgREI6OnRhYmxlKCd1c2VycycpCiAgICAgICAgLT53aGVyZSgnaWQnLHN0cnZhbCgkcmVxdWVzdC0+aWQpKQogICAgICAgIC0+dXBkYXRlKFsKICAgICAgICAgICAgJ2lkZW1wcmVzYScgICAgICAgICA9PiAkcmVxdWVzdC0+aWRlbXByZXNhLAogICAgICAgICAgICAnaWR0aXBvJyAgICAgICAgICAgID0+ICRyZXF1ZXN0LT50aXBvVHJhYmFqYWRvciwKICAgICAgICAgICAgJ25vbWJyZScJCQk9PiAkcmVxdWVzdC0+bm9tYnJlLAogICAgICAgICAgICAnYXBlbGxpZG9zJyAgICAgICAgID0+ICRyZXF1ZXN0LT5hcGVsbGlkb3MsCiAgICAgICAgICAgICdlbWFpbCcgICAgICAgICAgICAJPT4gJHJlcXVlc3QtPmVtYWlsLAogICAgICAgICAgICAvLyAndXN1YXJpbycgICAgICAgICAJPT4gJHJlcXVlc3QtPnVzdWFyaW8sCiAgICAgICAgICAgICdpZGRvY3VtZW50bycgICAgICAgPT4gJHJlcXVlc3QtPmlkZG9jdW1lbnRvLAogICAgICAgICAgICAnZGlyZWNjaW9uJyAgICAgICAgID0+ICRyZXF1ZXN0LT5kaXJlY2Npb24sCiAgICAgICAgICAgICducm9fZG9jdW1lbnRvJyAgICAgPT4gJHJlcXVlc3QtPm5yb19kb2N1bWVudG8sCiAgICAgICAgICAgICdjYXJnbycgICAgICAgIAkJPT4gJHJlcXVlc3QtPmNhcmdvLAogICAgICAgICAgICAnYXZhdGFyJyAgICAgICAgICAgID0+IG51bGwsCiAgICAgICAgICAgICd0ZWxlZm9ubycgICAgCQk9PiAkcmVxdWVzdC0+dGVsZWZvbm8sCiAgICAgICAgICAgICdhcmVhX3RyYWJhamFkb3InICAgPT4gJHJlcXVlc3QtPmFyZWFMYWJvcmFsLAogICAgICAgICAgICAnc2l0dWFjaW9uX2xhYm9yYWwnID0+ICRyZXF1ZXN0LT5zaXR1YWNpb25MYWJvcmFsLCAgCiAgICAgICAgICAgICdyZWdpbWVuX2xhYm9yYWwnICAgPT4gJHJlcXVlc3QtPnJlZ2ltZW5MYWJvcmFsLAogICAgICAgICAgICAnU0VYTycgICAgICAgICAgICAgPT4gJHJlcXVlc3QtPmlkU2V4bywgCiAgICAgICAgICAgICdnbG9zYScgICAgICAgICAgICAgPT4gJHJlcXVlc3QtPmdsb3NhIAogICAgICAgIF0pOwogICAgICAgICAgICAgICAgCiAgICAgICAgJGlkdXN1ID0gQXV0aDo6dXNlcigpLT5pZDsKICAgICAgICAkdmFsaWRhY2lvbiA9IERCOjp0YWJsZSgndmFsaWRhY2lvbicpLT53aGVyZSgnaWR1c3VhcmlvJywkaWR1c3UpLT5nZXQoKTsKCiAgICAgICAgCiAgICAgICAgaWYgKEF1dGg6OnVzZXIoKS0+aWR0aXBvID09ICdBRE0nKSB7CiAgICAgICAgICAgIGlmIChjb3VudCgkdmFsaWRhY2lvbikgPiAwKSB7ICAgICAgICAgICAKICAgICAgICAgICAgICAgIERCOjp0YWJsZSgndmFsaWRhY2lvbicpCiAgICAgICAgICAgICAgICAtPndoZXJlKCdpZHVzdWFyaW8nLHN0cnZhbCgkaWR1c3UpKQogICAgICAgICAgICAgICAgLT51cGRhdGUoWyd2YWxvcicgPT4gMl0pOyAgCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiByZWRpcmVjdCgnL3RyYWJhamFkb3JlcycpOwogICAgfQoKCgoKfQo=